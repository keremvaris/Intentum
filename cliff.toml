# git-cliff: conventional commit'lardan otomatik CHANGELOG
# https://git-cliff.org/docs/configuration/
# Commit mesajında body ve BREAKING CHANGE: kullanırsan CHANGELOG'da detay görünür (bkz. CONTRIBUTING.md).

[changelog]
# Dosya başında bir kez: CHANGELOG nasıl okunur
header = """
# Changelog

Bu dosya **conventional commit** mesajlarından otomatik üretilir. Commit'te **açıklama (body)** veya **BREAKING CHANGE:** eklersen CHANGELOG'da detay ve geriye dönük uyumsuzluk metni görünür. Nasıl yazılır: [CONTRIBUTING.md — Commit messages and CHANGELOG](CONTRIBUTING.md#commit-messages-and-changelog).

| İşaret | Anlam |
|--------|--------|
| **[sürüm]** (örn. 0.0.2) | O sürümde yayınlanan değişiklikler. |
| **Breaking changes** | Geriye dönük uyumsuz değişiklik; kütüphane kullananlar kodu güncellemeli. **BREAKING CHANGE:** footer'ı veya `feat!:` kullan. |
| **Features** | Yeni özellik (feat:) → minor sürüm artar. |
| **Bug Fixes** | Hata düzeltme (fix:) → patch artar. |
| **Documentation** | Doküman (docs:). |
| **Miscellaneous** | CI, chore, bakım işleri. |

---

"""

# Her sürüm bloğu: önce Breaking (açıklama + breaking_description), sonra diğer gruplar (message + body)
body = """
{% if version %}\
## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}\
## [unreleased]
{% endif %}\
{% for group, commits in commits | group_by(attribute="group") %}
{% if group == "Breaking" %}
### Breaking changes (geriye dönük uyumsuz)
{% for commit in commits %}
- **{{ commit.message | upper_first }}**{% if commit.scope %} *({{ commit.scope }})*{% endif %}
{% if commit.breaking_description %}
  - **Ne değişti:** {{ commit.breaking_description }}
{% endif %}\
{% if commit.body %}
  - **Açıklama:** {{ commit.body | trim }}
{% endif %}
{% endfor %}
{% endif %}\
{% endfor %}\
{% for group, commits in commits | group_by(attribute="group") %}
{% if group != "Breaking" %}
### {{ group | striptags | trim | upper_first }}
{% for commit in commits %}
- **{{ commit.message | upper_first }}**{% if commit.scope %} *({{ commit.scope }})*{% endif %}\
{% if commit.body %}

  {{ commit.body | trim }}
{% endif %}

{% endfor %}
{% endif %}\
{% endfor %}
"""
trim = true
render_always = true

[git]
conventional_commits = true
filter_unconventional = true
require_conventional = false
# Sıra önemli: ilk eşleşen kazanır. Breaking önce.
commit_parsers = [
  { message = "^[a-zA-Z]*!:", group = "Breaking" },
  { body = "BREAKING CHANGE", group = "Breaking" },
  { message = "^feat", group = "Features" },
  { message = "^fix", group = "Bug Fixes" },
  { message = "^doc", group = "Documentation" },
  { message = "^perf", group = "Performance" },
  { message = "^refactor", group = "Refactor" },
  { message = "^style", group = "Styling" },
  { message = "^test", group = "Testing" },
  { message = "^chore\\(release\\)", skip = true },
  { message = "^chore.*update CHANGELOG", skip = true },
  { message = "^chore|^ci", group = "Miscellaneous" },
  { message = ".*security", group = "Security" },
  { message = "^revert", group = "Revert" },
  { message = ".*", group = "Other" },
]
filter_commits = false
sort_commits = "oldest"
protect_breaking_commits = true